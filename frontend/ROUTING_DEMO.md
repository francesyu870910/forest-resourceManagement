# 前端路由和权限控制演示

## 功能概述

本次实现为森林资源管理系统添加了完整的前端路由和权限控制功能，包括：

### 1. 路由配置更新
- 添加了登录页面路由 (`/login`)
- 添加了密码重置页面路由 (`/reset-password`)
- 添加了用户管理页面路由 (`/users`)
- 为所有受保护的路由添加了认证要求
- 为用户管理页面添加了管理员权限要求

### 2. 路由守卫实现
- **认证守卫**: 未登录用户访问受保护路由时自动重定向到登录页面
- **权限守卫**: 非管理员用户访问管理员专用页面时重定向到概览页面
- **访客守卫**: 已登录用户访问登录页面时重定向到概览页面
- **页面标题**: 自动设置页面标题

### 3. API工具类更新
- 请求拦截器自动添加JWT Token到Authorization头
- 响应拦截器处理401未授权错误，自动清除认证信息并跳转登录页面
- 添加了用户管理相关的API方法

### 4. 导航菜单更新
- 根据用户角色动态显示菜单项（管理员可见用户管理菜单）
- 添加了用户信息显示和登出功能
- 支持移动端用户信息显示

## 测试场景

### 场景1: 未登录用户访问
1. 直接访问 `http://localhost:5173/overview`
2. 应该自动重定向到 `http://localhost:5173/login?redirect=/overview`
3. 登录成功后应该重定向回原始页面

### 场景2: 普通用户权限控制
1. 以普通用户身份登录
2. 尝试访问 `http://localhost:5173/users`
3. 应该重定向到 `http://localhost:5173/overview`
4. 导航菜单中不应显示"用户管理"选项

### 场景3: 管理员权限
1. 以管理员身份登录
2. 可以正常访问 `http://localhost:5173/users`
3. 导航菜单中显示"用户管理"选项

### 场景4: 已登录用户访问登录页面
1. 在已登录状态下访问 `http://localhost:5173/login`
2. 应该自动重定向到 `http://localhost:5173/overview`

### 场景5: Token过期处理
1. 在已登录状态下，当后端返回401错误时
2. 前端应该自动清除认证信息并跳转到登录页面

## API认证测试

所有API请求现在都会自动携带JWT Token：

```javascript
// 示例：获取用户列表
import { userApi } from '@/utils/api'

// 这个请求会自动添加 Authorization: Bearer <token> 头
const users = await userApi.getList()
```

## 路由守卫测试

可以运行测试文件来验证路由守卫功能：

```bash
npm run test frontend/src/tests/router.test.js
```

## 注意事项

1. 确保后端API支持JWT Token认证
2. 确保后端返回正确的用户角色信息
3. Token过期时间应该与后端设置保持一致
4. 在生产环境中考虑使用HTTPS来保护Token传输